# Moltly iOS (Capacitor)

This directory holds the Capacitor-based native container for the Moltly web app. Instead of a custom WKWebView wrapper, we rely on Capacitor's runtime so we can progressively introduce native plugins (push notifications, file system, camera, biometrics, etc.) without rewriting the UI.

## Prerequisites
- macOS with Xcode 15+
- Node.js 20+
- CocoaPods (`sudo gem install cocoapods`)

## Project structure
- `capacitor.config.ts` – shared Capacitor configuration at the repo root
- `mobile-shell/` – lightweight HTML bundle that ships with the app for the splash state; live content loads from the server declared in `capacitor.config.ts`
- `ios/App/` – native Swift project generated by Capacitor (`App.xcodeproj`)

## Typical workflow
1. Install JS deps: `npm install`
2. Set the server you want the container to load.
   - Production (default): nothing to do, the app hits `https://moltly.xyz`
   - Local dev: `export CAP_SERVER_URL="http://<your-mac-ip>:5777"`
3. Sync native code: `npm run mobile:sync`
4. Open Xcode: `npm run mobile:open`
5. Choose a simulator or device and press **Run**.

> `CAP_SERVER_URL` is read when you run Capacitor commands (`copy`, `sync`, `run`). Retain HTTPS in production; local HTTP URLs work because `NSAppTransportSecurity` allows local networking in the embedded web view.

## Updating icons / splash
Update `/app/icon.png` (1024×1024) and regenerate the asset catalog with:
```
npx cap sync ios
```
Then polish icons/splash screens directly in Xcode's asset catalog if needed.

## Adding native plugins
Install the plugin via npm (e.g., `npm install @capacitor/push-notifications`) and run `npm run mobile:sync` to let Capacitor autolink the native side. Remember to commit any new Swift files / Pod changes.
